<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/classList.css">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js"></script>
</head>


<body>
<header>
    <h1>사용자정보</h1>
    <nav>
        <td>학번 :</td>
        <td th:text="${session.loginMember.id}"></td>
        <span>&nbsp;이름: </span>
        <td th:text="${session.loginMember.name}"></td>
        <span>&nbsp;학과: </span>
        <span th:text="${session.loginMember.department}"></span>
        <span>&nbsp;학년: </span>
        <span th:text="${session.loginMember.grade}"></span>
        <span>&nbsp;최소수강신청학점: </span>
        <span th:text="${session.loginMember.maxCredits}"></span>
        <span>&nbsp;최대수강신청학점: </span>
        <span th:text="${session.loginMember.minCredits}"></span>
        <span>&nbsp;현재수강신청학점: </span>
        <span th:text="${session.loginMember.nowCredits}"></span>
    </nav>
    <form name="search-form" autocomplete="off">
        <input type="text" name="className" value=""></input>
        <input type="button" onclick="getSearchList()" class="btn btn-outline-light mr-2" value="검색"></input>
    </form>
    <button class="button" onclick="location.href='/logout'" style="vertical-align:middle; float:right;">
        <span>로그아웃</span></button>
</header>


<main>
    <!-- 유의사항/ 수강신청 검색 목록 -->
    <section>
        <div class="container">
            <div class="" style="overflow-y: scroll; height:23rem;">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>교과목명</th>
                        <th>학수번호</th>
                        <th>이수구분</th>
                        <th>분반</th>
                        <th>학점</th>
                        <th>담당교수</th>
                        <th>수강인원</th>
                        <th>제한인원</th>
                        <th>강의실명</th>
                        <th>강의시간</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="class : ${classes}">
                        <div class="row">
                            <td th:text="${class.className}"></td>
                            <td th:text="${class.id}"></td>
                            <td th:text="${class.division}"></td>
                            <td th:text="${class.distribution}"></td>
                            <td th:text="${class.credit}"></td>
                            <td th:text="${class.professor}"></td>
                            <td th:text="${class.curStudent}"></td>
                            <td th:text="${class.maxStudent}"></td>
                            <td th:text="${class.lectureRoom}"></td>
                            <td th:text="${class.time}"></td>
                            <td>
                                <button th:onclick="postTodo([[${class}]])" class="add-style">신청</button>
                            </td>
                        </div>
                    </tr>
                    </tbody>
                </table>
            </div><!-- /container -->
        </div>
        <hr/>
    </section>
    <!--장바구니, 프로필, 신청완료 과목 -->
    <section id="section-second">

        <div class="container">
            <nav>
                <!--Modal-->
                <button type="button" class="btn btn-primary me-1" data-bs-toggle="modal" data-bs-target="#myModal">
                    유의사항
                </button>
                <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="myModalLabel" role="dialog">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="myModalLabel">
                                    유의사항 안내 페이지
                                </h5>
                            </div>
                            <div class="modal-body">
                                <div class="h6-style">
                                    <p>[수강신청 안내]</p>
                                </div>
                                <div class="important">
                                    <p>
                                        타학과 신청은 10시에 다시 로그인 하기 바랍니다.<br>
                                    </p>
                                </div>
                                <div class="less-important">
                                    <p>
                                        -자학과 교과목 : 자학과로 개설된 전공강좌, 교양강좌를 조회할 수 있습니다.<br>
                                        -공통교양 : 공통학과로 개설된 교필, 교선, 자선, 교직강좌를 조회할 수 있습니다.<br>
                                        -융합전공 : 융합전공으로 개설된 강좌를 조회할 수 있습니다.<br>
                                        -장바구니 : 장바구니에 신청된 강좌를 불러올 수 있습니다.<br>
                                    </p>
                                </div>
                                <hr>
                                <div class="h6-style">
                                    <p>[강의평가 결과공개 원칙]</p>
                                </div>
                                <div class="less-important">
                                    <p>
                                        1. 직전학기 강의평가 결과 100% 공개를 원칙으로 함<br>
                                        2. 교과목별 담당교수의 강의평가결과를 참조하여 신중하게 신청하여야 함<br>
                                        3. 직전학기 전체 강좌를 각 단과대학별(4개 단과대학, 교양), 전임·비전임·시간강사별로 공개<br>
                                    </p>
                                </div>
                                <hr>
                                <div class="h6-style">
                                    <p>[대체 재수강신청 유의사항]</p>
                                </div>
                                <div class="less-important">
                                    <p>
                                        대체재수강 시 대체지정된 교과목이 본인 학과(부)의 전공 교과목이 아닐 경우(학과 학수번호코드 상이)또는
                                        대체지정 교과목간 학점이 틀려서 이후 전공학점 미달이 발생할 수 있으니 주의하기 바람.<br>
                                    </p>
                                    <div class="example">
                                        <p>예</p>
                                    </div>
                                    <p>
                                        본인 학과(부)의 전공 교과목이 아닐 경우(학과 학수번호 코드 상이)의 경우<br>

                                        폐지 교과목(BA1032/소비자행동) ➜➜ 지정 교과목(LM5001/소비자행동)<br>
                                        ➠ 경영학부 전공 학생이 이전 "BA1032 소비자행동"교과목의 성적을 삭제하기 위해<br>
                                        "LM5001 소비자행동"교과목을 대체재수강 한 경우 "LM5001 소비자행동"은 일반선택이 되므로
                                        이후 전공학점 미달이 발생할 수 있음<br>
                                    </p>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-bs-dismiss="modal">확인</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!--모달 끝-->

                <!--모달 끝-->

                <button type="button" class="btn btn-primary" data-toggle="button" aria-pressed="false" id="jangba"
                        autocomplete="off">
                    장바구니
                </button>
                <button type="button" class="btn btn-primary" data-toggle="button" aria-pressed="false" id=""
                        autocomplete="off">
                    신청 목록
                </button>
            </nav>
            <div class="container" style="overflow: hidden; ">
                <!-- 사용자 프로필 -->
                <!--                <aside id="aside-first">-->
                <!--                    <div th:if="${session.loginMember != null}" class="container col-sm-2 spanlist aside1">-->
                <!--                        <div class="card bg-light mb-3" style="max-width: 18rem;">-->
                <!--                            <div class="card-body">-->
                <!--                                <div class="card-text" width="150px;" id="text-list">-->
                <!--                                    <div class="normal">-->
                <!--                                        <td>학번 : </td>-->
                <!--                                        <td th:text="${session.loginMember.id}"></td>-->
                <!--                                        <span>이름: </span>-->
                <!--                                        <td th:text="${session.loginMember.name}"></td>-->
                <!--                                        <span>학과: </span>-->
                <!--                                        <span th:text="${session.loginMember.department}"></span>-->
                <!--                                        <span>학년: </span>-->
                <!--                                        <span th:text="${session.loginMember.grade}"></span>-->
                <!--                                        <span>최소수강신청학점: </span>-->
                <!--                                        <span th:text="${session.loginMember.maxCredits}"></span>-->
                <!--                                        <span>최대수강신청학점: </span>-->
                <!--                                        <span th:text="${session.loginMember.minCredits}"></span>-->
                <!--                                        <span>현재수강신청학점: </span>-->
                <!--                                        <span th:text="${session.loginMember.minCredits}"></span>-->
                <!--                                    </div>-->
                <!--                                </div>-->
                <!--                            </div>-->
                <!--                        </div>-->
                <!--                    </div>-->
                <!--                </aside>-->
                <!-- 토글바 메뉴 콘텐츠 -->
                <tr th:each="register : ${registers}">
                    <aside class="col-sm-2 spanlist" id="aside-second">
                        <div class="card bg-primary mb-3 text-white">
                            <a th:onclick="deleteTodo([[${register.classEntity}]])" class="btn">
                                <div class="card-body">
                                    <h5 class="card-title type-2" th:text="${register.classEntity.id}">class.id</h5>
                                    <div class="card-text" width="50px;">
                                        <div class="type-1">
                                            <span th:text="${register.classEntity.className}"/></span><br/>
                                        </div>
                                        <div class="type-2">
                                            <span>학수 번호</span><br/>
                                        </div>
                                        <div class="type-3">
                                            <span>이수 구분</span><br/>
                                            <span>분반</span><br/>
                                            <span>학점</span><br/>
                                        </div>
                                        <div class="type-4">
                                            <span>담당 교수</span><br/>
                                        </div>
                                        <div class="type-5">
                                            <span>수강 인원</span><br/>
                                            <span>제한 인원</span><br/>
                                        </div>
                                        <div class="type-6">
                                            <span>강의실 명</span><br/>
                                            <span>강의 시간</span><br/>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </aside>
                </tr>
            </div>
        </div>
    </section>
</main>
<script>
    // ajax로 포스트 돌리는것.
    function postTodo(classJson) {
        let xhr = new XMLHttpRequest();
        xhr.open('post', 'http://localhost:8080/register');
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        console.log(JSON.stringify(classJson));
        xhr.onload = function(){
            alert('수강신청되었습니다.');
        };
        xhr.send(JSON.stringify(classJson));
    }

    function deleteTodo(classJson){
        let xhr = new XMLHttpRequest();
        xhr.open('DELETE','http://localhost:8080/register');
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xhr.onload = function(){
            alert('수강취소되었습니다.');
        };
        xhr.send(JSON.stringify(classJson));
    }

</script>
</body>
</html>